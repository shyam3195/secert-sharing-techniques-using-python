<html>

<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <!-- <script src="jquery-3.6.0.min.js"></script> -->
  <script>
    $(function () {
      $("#encrypt_result").hide()
      $("#decrypt_result").hide()
      $("#encrypt_text_div").hide()
      $("#file").on('change', function () {
        console.log($("#file").val())
        const changed_file_val = $("#file").val();
        if (changed_file_val === 'tx_field') {
          $("#encrypt_text_div").show()
          $("#txt_data_field").show()
        }
      })

      $('#encrypt_submit_btn').click(function () {
        const text_val = {
          "data_to_encrypt": $("#txt_data_field").val(),
          "email": $("#email_txt").val()
        }
        console.log("text_val", text_val)
        fetch('http://127.0.0.1:5000/encrypt/shamir', {
          method: 'POST', // or 'PUT'
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(text_val),
        })
          .then(response => response.json())
          .then(data => {
            console.log('Success:', data);
            $("#encrypt_result").val(JSON.stringify(data.data))
            $("#decrypt_div").show()
          })
          .catch((error) => {
            console.error('Error:', error);
          });
      })

      $('#decrypt_submit_btn').click(function () {
        console.log($("#decrypt_text").val())
        console.log(typeof ($("#decrypt_text").val()))
        const text_val = {"encrypted_data": $("#decrypt_text").val()}
        console.log("text_val", text_val)
        fetch('http://127.0.0.1:5000/decrypt/shamir', {
          method: 'POST', // or 'PUT'
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(text_val),
        })
          .then(response => response.json())
          .then(data => {
            console.log('Success:', data);
            $("#decrypt_result").val(JSON.stringify(data.data))
            $("#decrypt_result").show()
          })
          .catch((error) => {
            console.error('Error:', error);
          });
      })

    });
  </script>
  <title>
    Shyam Security Project
  </title>
  <style>
    .active {
      color: teal;
      border-bottom-color: teal;
    }

    .tab {
      display: none;
    }

    .tab:target {
      display: block;
    }

    .tab:last-child {
      display: block;
    }

    .tab:last-child {
      display: block;
    }

    .tab:target~.tab:last-child {
      display: none;
    }
  </style>
</head>

<body>

  <section class="tab" id="last-tab">
    <nav>
      <a href="#first-tab">Encryption</a>
      <a href="#last-tab" class="active">Decryption</a>
    </nav>
    <b>Decryption</b>
    <textarea id="decrypt_text" cols="50" rows="20" ></textarea><br/>
    <textarea id="decrypt_result" cols="50" rows="6" ></textarea><br/>
    <button id="decrypt_submit_btn">
      Decrypt
    </button>
    <br/>

  </section>
  <section class="tab" id="first-tab">
    <nav>
      <a href="#first-tab" class="active">Encryption</a>
      <a href="#last-tab">Decryption</a>
    </nav>
    <label for="file">Choose Input file type:</label>

    <select name="file" id="file">
      <option value="tx_field">Text field</option>
      <option value="img_file">Image File</option>
      <option value="pdf_file">Pdf File</option>
    </select><br/>
    <div id="encrypt_text_div">
      <span>Data to Decrypt</span>
      <input id="txt_data_field" type="text" style="display: none;" />
    </div>
    <label for="sharing">Choose Sharing Technique:</label>

    <select name="sharing" id="sharing">
      <option value="shamir">Shamir</option>
      <option value="tc2">Technique 2</option>
      <option value="tc3">Technique 3</option>
    </select>
    <br/>
    <div>
      <p>Enter email address of the recepient</p>
      <input type="text" id="email_txt" />
    </div>
    <br/>

    <textarea id="encrypt_result" cols="50" rows="20" >

    </textarea>
    <br/>
    <button id="encrypt_submit_btn" class="ui primary button">
      Encrypt
    </button>
    <br/>
  </section>


</body>

</html>